{extend name="userbase" /}
{block name="body"}
<div class="fly-panel fly-panel-user" pad20="">
    <div class="content-header mb20">
        <ul class="header-item-container">
            <li class="header-item active"><a href="javascript:;">绑定账号</a></li>
        </ul>
    </div>
    {if condition="empty($userInfo.mobile) or empty($userInfo.nickname)"}
    <form class="layui-form" action="{:request()->url()}" method="post">
        {if condition="$regfield[0]['status']==1"}
        <div class="layui-form-item">
            <label class="layui-form-label">所在年级<span class="required-item">*</span></label>
            <div class="layui-input-block" style="width:350px;">
                <select name="greadId">
                    <option value="">选择年级</option>
                    {foreach name="grade" item="v"}
                    <option value="{$v.id}">{$v.name}</option>
                    {/foreach}
                </select>
            </div>
        </div>
        {/if}
        {if condition="$regfield[1]['status']==1"}
        <div class="layui-form-item">
            <label class="layui-form-label">所在学校<span class="required-item">*</span></label>
            <div class="layui-input-block" style="width:350px;">
                <select name="schoolId">
                    <option value="">选择学校</option>
                    {foreach name="school" item="v"}
                    <option value="{$v.id}">{$v.name}</option>
                    {/foreach}
                </select>
            </div>
        </div>
        {/if}
        {if condition="empty($userInfo.mobile)"}
        <div class="layui-form-item">
            <label class="layui-form-label">手机号码<span class="required-item">*</span></label>
            <div class="layui-input-block" style="width:350px;">
                <input type="text" id="mobile" name="mobile" lay-verify="required|phone" placeholder="可用于登录和找回账号密码" autocomplete="off" class="layui-input">
            </div>
        </div>
        {if condition="$data.status eq 1"}
        <div class="layui-form-item">
            <label class="layui-form-label">手机验证码<span class="required-item">*</span></label>
            <div class="layui-input-block" style="width:350px;">
                <input type="text" id="phoneCode" class="layui-input layui-input-inline" name="codeverify" placeholder="请输入手机验证码" lay-verify="required" maxlength="6" style="width:220px;">
                <input type="button" class="layui-btn layui-btn-primary getPhoneCode generate_code" value=" 获取验证码" style="float:right;" url="{:url('api/author/regCode')}">
            </div>
        </div>
        {/if}
        {/if}
        {if condition="empty($userInfo.username)"}
        <div class="layui-form-item">
            <label class="layui-form-label">登录用户名<span class="required-item">*</span></label>
            <div class="layui-input-block" style="width:350px;">
                <input type="text" name="username" lay-verify="required|username" placeholder="可以绑定已有用户名，也可以绑定新用户名，绑定后不可修改" autocomplete="off" class="layui-input">
                <input type="hidden" name="__token__" value="{$Request.token}" />
            </div>
        </div>
        {/if}
        <div class="layui-form-item">
            <label class="layui-form-label">显示昵称<span class="required-item">*</span></label>
            <div class="layui-input-block" style="width:350px;">
                <input type="text" name="nickname" lay-verify="required|username" placeholder="可用于系统显示名，可以修改" autocomplete="off" class="layui-input">
            </div>
        </div>
        {if condition="empty($userInfo.username)"}
        <div class="layui-form-item">
            <label class="layui-form-label">登录密码<span class="required-item">*</span></label>
            <div class="layui-input-block" style="width:350px;">
                <input type="password"  name="password" lay-verify="required|password" placeholder="用于用户名或者手机号登录时的密码" autocomplete="off" class="layui-input">
            </div>
        </div>
        {/if}
        <div class="layui-form-item mt50">
            <div class="layui-input-block">
                <button class="layui-btn"  lay-submit="" lay-filter="*">绑定</button>
            </div>
        </div>
    </form>
    {else /}
    <div class="layui-form-item">
        <label class="layui-form-label">已绑定手机<span class="required-item">*</span></label>
        <div class="layui-input-block" style="width:350px;">
            <input type="text" value="{$userInfo.mobile}" disabled="undisabled"  class="layui-input layui-disabled">
        </div>
    </div>
    {/if}
</div>
{/block}
{block name="js"}

{/block}